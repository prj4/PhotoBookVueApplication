{"remainingRequest":"C:\\PhotoBookVueApplication\\Photobookvueapplication\\Photobookvueapplication\\node_modules\\babel-loader\\lib\\index.js!C:\\PhotoBookVueApplication\\Photobookvueapplication\\Photobookvueapplication\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\PhotoBookVueApplication\\Photobookvueapplication\\Photobookvueapplication\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\PhotoBookVueApplication\\Photobookvueapplication\\Photobookvueapplication\\src\\components\\HostEventPage.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\PhotoBookVueApplication\\Photobookvueapplication\\Photobookvueapplication\\src\\components\\HostEventPage.vue","mtime":1558989980574},{"path":"C:\\PhotoBookVueApplication\\Photobookvueapplication\\Photobookvueapplication\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\PhotoBookVueApplication\\Photobookvueapplication\\Photobookvueapplication\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\PhotoBookVueApplication\\Photobookvueapplication\\Photobookvueapplication\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\PhotoBookVueApplication\\Photobookvueapplication\\Photobookvueapplication\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.split\";\nimport \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/es6.function.name\";\nimport _JSON$stringify from \"C:\\\\PhotoBookVueApplication\\\\Photobookvueapplication\\\\Photobookvueapplication\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/json/stringify\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"C:\\\\PhotoBookVueApplication\\\\Photobookvueapplication\\\\Photobookvueapplication\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _Promise from \"C:\\\\PhotoBookVueApplication\\\\Photobookvueapplication\\\\Photobookvueapplication\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/promise\";\nimport \"core-js/modules/es6.regexp.replace\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport JSZip from 'jszip';\nimport { saveAs } from 'file-saver';\nexport default {\n  methods: {\n    downloadPhotos: function downloadPhotos() {\n      var zip = new JSZip();\n      var count = 0;\n      var zipFilename = \"Photos.zip\";\n      var vuecomponent = this;\n      var FullSizePhotoArray = [\n        /*...*/\n      ];\n\n      var _loop = function _loop(e) {\n        var specificpictureurl = 'https://photobookwebapi1.azurewebsites.net/api/Picture/' + vuecomponent.EventPin + '/' + vuecomponent.EventPhotoIDs[e];\n        fetch(specificpictureurl, {\n          credentials: 'include',\n          mode: 'cors'\n        }).then(function (response) {\n          if (response.status == '200') {\n            response.blob().then(function (image) {\n              FullSizePhotoArray[e] = URL.createObjectURL(image);\n              var filename = FullSizePhotoArray[e];\n              filename = filename.replace(/[\\/\\*\\|\\:\\<\\>\\?\\\"\\\\]/gi, '').replace(\"blobhttplocalhost1337\", \"\").replace(\"blobhttpsphotobookvue.z16.web.core.windows.net\", \"\"); // loading a file and add it in a zip file\n\n              JSZipUtils.getBinaryContent(FullSizePhotoArray[e], function (err, data) {\n                if (err) {\n                  throw err; // or handle the error\n                }\n\n                zip.file(filename + '.jpg', data, {\n                  binary: true\n                });\n                count++;\n                vuecomponent.bar.animate(count / vuecomponent.EventPhotos.length);\n\n                if (count == vuecomponent.EventPhotos.length) {\n                  zip.generateAsync({\n                    type: 'blob'\n                  }).then(function (content) {\n                    saveAs(content, zipFilename);\n                    vuecomponent.bar.animate(0);\n                  });\n                }\n              });\n            });\n          } else {\n            FullSizePhotoArray[e] = null;\n            count++;\n          }\n        });\n      };\n\n      for (var e = 0; e < vuecomponent.EventPhotoIDs.length; e++) {\n        _loop(e);\n      }\n    },\n    deleteEvent: function deleteEvent() {\n      if (confirm(\"Are you sure that you want to delete \" + this.thisEventName + \"?\")) {\n        var url = 'https://photobookwebapi1.azurewebsites.net/api/Event/' + this.EventPin;\n        var vuecomponent = this;\n        fetch(url, {\n          method: 'DELETE',\n          credentials: 'include',\n          headers: new Headers({\n            'Content-Type': 'application/json',\n            'Accept': 'application/json'\n          }),\n          mode: 'cors'\n        }).then(function (response) {\n          if (response.status == '200' || response.status == '204') {\n            vuecomponent.$router.push({\n              path: \"/HostHomePage\"\n            });\n          }\n        });\n      }\n    },\n    onFileChange: function onFileChange(event) {\n      this.UploadPhotos.length = 0;\n\n      for (var i = 0; i < event.target.files.length; i++) {\n        this.$set(this.UploadPhotos, i, event.target.files[i]);\n      }\n\n      this.onUpload();\n    },\n    readFile: function readFile(file) {\n      return new _Promise(function (resolve, reject) {\n        var reader = new FileReader();\n\n        reader.onload = function () {\n          resolve(reader.result.replace(/data:image\\/png;base64,|data:image\\/jpeg;base64,|data:image\\/gif;base64,/gi, ''));\n        };\n\n        reader.onerror = reject;\n        reader.readAsDataURL(file);\n      });\n    },\n    onUpload: function () {\n      var _onUpload = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        var _this = this;\n\n        var url, vuecomponent, _loop2, i;\n\n        return regeneratorRuntime.wrap(function _callee$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                url = 'https://photobookwebapi1.azurewebsites.net/api/Picture';\n                vuecomponent = this;\n                _loop2 =\n                /*#__PURE__*/\n                regeneratorRuntime.mark(function _loop2(i) {\n                  var base64Img, dataToBeSend;\n                  return regeneratorRuntime.wrap(function _loop2$(_context) {\n                    while (1) {\n                      switch (_context.prev = _context.next) {\n                        case 0:\n                          vuecomponent.bar.animate((i + 1) / _this.UploadPhotos.length);\n                          _context.next = 3;\n                          return _this.readFile(_this.UploadPhotos[i]);\n\n                        case 3:\n                          base64Img = _context.sent;\n                          dataToBeSend = {\n                            pictureString: base64Img,\n                            eventPin: vuecomponent.EventPin\n                          };\n                          _context.next = 7;\n                          return fetch(url, {\n                            method: 'POST',\n                            credentials: 'include',\n                            headers: new Headers({\n                              'Content-Type': 'application/json',\n                              'Accept': 'application/json'\n                            }),\n                            mode: 'cors',\n                            body: _JSON$stringify(dataToBeSend)\n                          }).then(function (response) {\n                            if (i == vuecomponent.UploadPhotos.length - 1) {\n                              vuecomponent.bar.animate(0.0);\n                              vuecomponent.getEventPhotos();\n                            }\n\n                            if (response.status != '200') {\n                              alert(\"Images failed to upload\");\n                            }\n                          });\n\n                        case 7:\n                        case \"end\":\n                          return _context.stop();\n                      }\n                    }\n                  }, _loop2);\n                });\n                i = 0;\n\n              case 4:\n                if (!(i < this.UploadPhotos.length)) {\n                  _context2.next = 9;\n                  break;\n                }\n\n                return _context2.delegateYield(_loop2(i), \"t0\", 6);\n\n              case 6:\n                i++;\n                _context2.next = 4;\n                break;\n\n              case 9:\n                while (this.UploadPhotos.length != 0) {\n                  this.UploadPhotos.pop();\n                }\n\n              case 10:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function onUpload() {\n        return _onUpload.apply(this, arguments);\n      }\n\n      return onUpload;\n    }(),\n    getEventPhotos: function getEventPhotos() {\n      var picturelisturl = 'https://photobookwebapi1.azurewebsites.net/api/Picture/Ids/' + this.EventPin;\n      var vuecomponent = this;\n      fetch(picturelisturl, {\n        credentials: 'include',\n        headers: new Headers({\n          'Content-Type': 'application/json',\n          'Accept': 'application/json',\n          'Accept-Encoding': 'gzip, deflate, br',\n          'Accept-Language': 'da, en-US; q=0.9, en; q=0.8, de; q=0.7, nb; q=0.6'\n        }),\n        mode: 'cors'\n      }).then(function (response) {\n        if (response.status == '200') {\n          response.json().then(function (data) {\n            return {\n              body: data\n            };\n          }).then(function (data) {\n            for (var i = 0; i < data.body.pictureList.length; i++) {\n              vuecomponent.$set(vuecomponent.EventPhotoIDs, i, data.body.pictureList[i]);\n            }\n          }).then(function () {\n            vuecomponent.$cookie.set('currenteventphotoids', _JSON$stringify(vuecomponent.EventPhotoIDs));\n            vuecomponent.updatepage();\n          });\n        }\n      });\n    },\n    updatepage: function () {\n      var _updatepage = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2() {\n        var vuecomponent, _loop3, e;\n\n        return regeneratorRuntime.wrap(function _callee2$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                vuecomponent = this;\n                _loop3 =\n                /*#__PURE__*/\n                regeneratorRuntime.mark(function _loop3(e) {\n                  var specificpictureurl;\n                  return regeneratorRuntime.wrap(function _loop3$(_context3) {\n                    while (1) {\n                      switch (_context3.prev = _context3.next) {\n                        case 0:\n                          specificpictureurl = 'https://photobookwebapi1.azurewebsites.net/api/Picture/Preview/' + vuecomponent.EventPin + '/' + vuecomponent.EventPhotoIDs[e];\n                          _context3.next = 3;\n                          return fetch(specificpictureurl, {\n                            credentials: 'include',\n                            mode: 'cors'\n                          }).then(function (response) {\n                            if (response.status == '200') {\n                              response.blob().then(function (image) {\n                                vuecomponent.$set(vuecomponent.EventPhotos, e, URL.createObjectURL(image));\n                              });\n                            } else {\n                              vuecomponent.$set(vuecomponent.EventPhotos, e, null);\n                            }\n                          });\n\n                        case 3:\n                        case \"end\":\n                          return _context3.stop();\n                      }\n                    }\n                  }, _loop3);\n                });\n                e = 0;\n\n              case 3:\n                if (!(e < vuecomponent.EventPhotoIDs.length)) {\n                  _context4.next = 8;\n                  break;\n                }\n\n                return _context4.delegateYield(_loop3(e), \"t0\", 5);\n\n              case 5:\n                e++;\n                _context4.next = 3;\n                break;\n\n              case 8:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function updatepage() {\n        return _updatepage.apply(this, arguments);\n      }\n\n      return updatepage;\n    }(),\n    logout: function logout() {\n      var url = 'https://photobookwebapi1.azurewebsites.net/api/Account/Logout';\n      var router = this.$router;\n      var cookie = this.$cookie;\n      fetch(url, {\n        method: 'POST',\n        credentials: 'include',\n        headers: new Headers({\n          'Content-Type': 'application/json',\n          'Accept': 'application/json'\n        }),\n        mode: 'cors'\n      }).then(function (response) {\n        if (response.status == '200' || response.status == '204') {\n          cookie.delete('LoggedInGuest');\n          cookie.delete('currenteventpin');\n          cookie.delete('currenteventname');\n          cookie.delete('currentguest');\n          router.push({\n            name: 'Home'\n          });\n        } else {\n          alert(\"Failed to log out\");\n        }\n      });\n    },\n    getEventInfo: function getEventInfo() {\n      var vuecomponent = this;\n      var url = 'https://photobookwebapi1.azurewebsites.net/api/Event/' + vuecomponent.EventPin;\n      fetch(url, {\n        credentials: 'include',\n        mode: 'cors'\n      }).then(function (response) {\n        if (response.status == '200') {\n          response.json().then(function (data) {\n            return {\n              body: data\n            };\n          }).then(function (data) {\n            vuecomponent.EventName = data.body.name;\n            vuecomponent.EventDescription = data.body.description;\n            vuecomponent.EventLocation = data.body.location;\n            {\n              var DateObject = new Date(Date.parse(data.body.startDate));\n              var FullDateString = DateObject.toString();\n              var dateArray = FullDateString.split('');\n              dateArray.splice(FullDateString.indexOf('GMT') - 4);\n              var shorterDate = dateArray.join('');\n              vuecomponent.EventStarttime = shorterDate;\n            }\n            {\n              var _DateObject = new Date(Date.parse(data.body.endDate));\n\n              var _FullDateString = _DateObject.toString();\n\n              var dateArray = _FullDateString.split('');\n\n              dateArray.splice(_FullDateString.indexOf('GMT') - 4);\n              var shorterDate = dateArray.join('');\n              vuecomponent.EventEndtime = shorterDate;\n            }\n          });\n        }\n      });\n    }\n  },\n  data: function data() {\n    return {\n      zippedPhotos: null,\n      EventPhotoIDs: [\n        /*...*/\n      ],\n      EventPhotos: [\n        /*...*/\n      ],\n      UploadPhotos: [\n        /*...*/\n      ],\n      EventPin: null,\n      EventHostName: this.$cookie.get('LoggedInHostName'),\n      HostEmail: this.$cookie.get('LoggedInEmail'),\n      thisEventName: null,\n      EventDescription: null,\n      EventLocation: null,\n      EventStarttime: null,\n      EventEndtime: null,\n      bar: null\n    };\n  },\n  beforeMount: function beforeMount() {\n    if (this.$cookie.get('LoggedInHost') != 'True') {\n      this.$router.push({\n        name: 'Home'\n      });\n      return;\n    }\n\n    if (this.$cookie.get('currenteventname') == null) {\n      this.$cookie.set('currenteventname', this.$route.params.EventName);\n      this.$cookie.set('currenteventpin', this.$route.params.Pin);\n    } else if (this.$route.params.EventName != null && this.$cookie.get('currenteventname') != this.$route.params.EventName) {\n      this.$cookie.set('currenteventname', this.$route.params.EventName);\n      this.$cookie.set('currenteventpin', this.$route.params.Pin);\n    }\n\n    this.EventPin = this.$cookie.get('currenteventpin');\n    this.thisEventName = this.$cookie.get('currenteventname');\n    this.getEventPhotos();\n    this.getEventInfo();\n  },\n  mounted: function mounted() {\n    var ProgressBar = require('progressbar.js');\n\n    this.bar = new ProgressBar.Circle(container, {\n      strokeWidth: 10,\n      easing: 'easeInOut',\n      duration: 500,\n      color: '#f4766f',\n      trailWidth: 0,\n      svgStyle: null\n    });\n  }\n};",{"version":3,"sources":["HostEventPage.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n    <div id=\"WrapperInternalPage\" class=\"Wrapper\">\r\n\r\n        <div class=\"WrapperTopNav\">\r\n            <a>    {{thisEventName}} hosted by {{EventHostName}}</a> <br />\r\n            <div>\r\n                <label class=\"inputlabel\" for=\"file\">\r\n                    <span v-if=\"UploadPhotos.length > 0\">{{UploadPhotos.length}} images selected</span>\r\n                    <span v-else>Upload</span>\r\n                </label>\r\n\r\n                <input name=\"file\" id=\"file\" class=\"inputfile\" accept=\"image/*\" type=\"file\" @change=\"onFileChange\" multiple>\r\n                <button class=\"smallbutton\" @click=\"deleteEvent\">Delete Event</button>\r\n                <button class=\"smallbutton\" @click=\"downloadPhotos\">Download All</button>\r\n            </div>\r\n        </div>\r\n\r\n\r\n\r\n        <div class=\"ContentBox\">\r\n            <a> Event Pin: {{EventPin}} </a> <br />\r\n            <a> Location: {{EventLocation}} </a><br />\r\n            <a> Description: {{EventDescription}}</a><br />\r\n            <a> Starting: <time datetime=\"DD-MM-YY:hh:mmTZD\">{{EventStarttime}}</time> - Ending: {{EventEndtime}} </a><br />\r\n            <div v-if=\"EventPhoto != null\" v-for=\"(EventPhoto,index) in EventPhotos\" v-bind:key=\"EventPhoto\" class=\"imgdiv\">\r\n                <router-link :to=\"{name: 'HostBigPhotoPage', params: {PictureIDindex: index}}\">\r\n                    <img class=\"previewImg\" :src=\"EventPhoto\" /><br />\r\n                </router-link>\r\n            </div>\r\n\r\n        </div>\r\n\r\n        <div id=\"container\"></div>\r\n    </div>\r\n    \r\n</template>\r\n\r\n\r\n\r\n<script>\r\n\r\n    import JSZip from 'jszip' \r\n    import { saveAs } from 'file-saver';\r\n    \r\n\r\n    export default {\r\n\r\n        methods: {\r\n            downloadPhotos: function () {\r\n                \r\n                var zip = new JSZip();\r\n                var count = 0;\r\n                var zipFilename = \"Photos.zip\";\r\n                var vuecomponent = this;\r\n                let FullSizePhotoArray = [/*...*/]\r\n                \r\n                for (let e = 0; e < vuecomponent.EventPhotoIDs.length; e++) {\r\n\r\n                    let specificpictureurl = 'https://photobookwebapi1.azurewebsites.net/api/Picture/' + vuecomponent.EventPin + '/' + vuecomponent.EventPhotoIDs[e];\r\n\r\n                    fetch(specificpictureurl, {\r\n                        credentials: 'include',\r\n                        mode: 'cors'\r\n                    })\r\n                        .then(function (response) {\r\n                            if (response.status == '200') {\r\n                                response.blob()\r\n                                    .then(image => {\r\n                                        FullSizePhotoArray[e] = URL.createObjectURL(image);\r\n\r\n                                        var filename = FullSizePhotoArray[e];\r\n                                        filename = filename.replace(/[\\/\\*\\|\\:\\<\\>\\?\\\"\\\\]/gi, '').replace(\"blobhttplocalhost1337\", \"\").replace(\"blobhttpsphotobookvue.z16.web.core.windows.net\",\"\");\r\n                                        // loading a file and add it in a zip file\r\n                                        JSZipUtils.getBinaryContent(FullSizePhotoArray[e], function (err, data) {\r\n                                            if (err) {\n                                                throw err; // or handle the error\n                                            }\r\n                                            zip.file(filename + '.jpg', data, { binary: true });\r\n                                            count++;\r\n                                            vuecomponent.bar.animate((count / vuecomponent.EventPhotos.length));\r\n                                            if (count == vuecomponent.EventPhotos.length) {\r\n                                                zip.generateAsync({ type: 'blob' }).then(function (content) {\r\n                                                    saveAs(content, zipFilename);\r\n                                                    vuecomponent.bar.animate(0);\r\n                                                });\r\n                                            }\r\n                                        });\r\n\r\n                                    })\r\n\r\n                            }\r\n                            else {\r\n                                FullSizePhotoArray[e] = null;\r\n                                count++\r\n                            }\r\n                        })\r\n\r\n                }\r\n\r\n\r\n            },\r\n            deleteEvent: function () {\r\n                if (confirm(\"Are you sure that you want to delete \" + this.thisEventName + \"?\")) {\r\n                    var url = 'https://photobookwebapi1.azurewebsites.net/api/Event/' + this.EventPin;\r\n                    var vuecomponent = this;\r\n\r\n                    fetch(url, {\r\n                        method: 'DELETE',\r\n                        credentials: 'include',\r\n                        headers: new Headers({\r\n                            'Content-Type': 'application/json', 'Accept': 'application/json'\r\n                        }),\r\n                        mode: 'cors',\r\n\r\n                    })\r\n                        .then(function (response) {\r\n                            if (response.status == '200' || response.status == '204') {\r\n                                vuecomponent.$router.push({ path: `/HostHomePage` })\r\n                            }\r\n\r\n                        })\r\n                }\r\n            },\r\n            onFileChange: function (event) {\r\n                this.UploadPhotos.length = 0;\r\n                for (var i = 0; i < event.target.files.length; i++) {\r\n                    this.$set(this.UploadPhotos, i, event.target.files[i]);\r\n                }\r\n                this.onUpload();\r\n            },\r\n            readFile: function (file) {\r\n                return new Promise((resolve, reject) => {\r\n\r\n                    let reader = new FileReader();\r\n                    \r\n                    reader.onload = () => {\r\n                        resolve(reader.result.replace(/data:image\\/png;base64,|data:image\\/jpeg;base64,|data:image\\/gif;base64,/gi, ''));\r\n                    };\r\n\r\n                    reader.onerror = reject;\r\n\r\n                    reader.readAsDataURL(file);\r\n\r\n                })\r\n            },\r\n            \r\n            onUpload: async function () {\r\n                var url = 'https://photobookwebapi1.azurewebsites.net/api/Picture'\r\n\r\n                var vuecomponent = this;\r\n\r\n                for( let i = 0; i < this.UploadPhotos.length; i++ ){\r\n                \r\n                    vuecomponent.bar.animate(((i+1) / this.UploadPhotos.length));\r\n                     let base64Img = await this.readFile(this.UploadPhotos[i])\r\n\r\n                        let dataToBeSend = {\r\n                            pictureString: base64Img,\r\n                            eventPin: vuecomponent.EventPin\r\n                        };\r\n\r\n                        await fetch(url, {\r\n                            method: 'POST',\r\n                            credentials: 'include',\r\n                            headers: new Headers({\r\n                                'Content-Type': 'application/json', 'Accept': 'application/json'\r\n                            }),\r\n                            mode: 'cors',\r\n                            body: JSON.stringify(dataToBeSend)\r\n                        })\r\n                            .then(function (response) {\r\n                                if (i == vuecomponent.UploadPhotos.length - 1 ) {\r\n                                    vuecomponent.bar.animate(0.0);\r\n                                    vuecomponent.getEventPhotos();\r\n                                    \r\n                                }\r\n                                if (response.status != '200') {\r\n                                    alert(\"Images failed to upload\")\r\n                                }\r\n\r\n                            })\r\n\r\n                       \r\n                }\r\n\r\n                while (this.UploadPhotos.length != 0) {\r\n                    this.UploadPhotos.pop();\r\n                }\r\n\r\n                \r\n\r\n            },\r\n            getEventPhotos: function () {\r\n                var picturelisturl = 'https://photobookwebapi1.azurewebsites.net/api/Picture/Ids/' + this.EventPin;\r\n                var vuecomponent = this;\r\n\r\n                fetch(picturelisturl, {\r\n                    credentials: 'include',\r\n                    headers: new Headers({\r\n                        'Content-Type': 'application/json',\r\n                        'Accept': 'application/json',\r\n                        'Accept-Encoding': 'gzip, deflate, br',\r\n                        'Accept-Language': 'da, en-US; q=0.9, en; q=0.8, de; q=0.7, nb; q=0.6'\r\n\r\n                    }),\r\n                    mode: 'cors'\r\n                })\r\n                    .then(function (response) {\r\n                        if (response.status == '200') {\r\n                            response.json()\r\n                                .then(data => ({ body: data }))\r\n                                .then(function (data) {\r\n                                    for (let i = 0; i < data.body.pictureList.length; i++) {\r\n                                        vuecomponent.$set(vuecomponent.EventPhotoIDs, i, data.body.pictureList[i]);\r\n                                        \r\n                                    }\r\n                                    \r\n                                })\r\n                                .then(function () {\r\n                                    vuecomponent.$cookie.set('currenteventphotoids', JSON.stringify(vuecomponent.EventPhotoIDs))\r\n                                    vuecomponent.updatepage();\r\n                                })\r\n                        }\r\n                    })\r\n            },\r\n\r\n            updatepage: async function () {\r\n                var vuecomponent = this;\r\n                \r\n                for (let e = 0; e < vuecomponent.EventPhotoIDs.length; e++) {\r\n\r\n                    let specificpictureurl = 'https://photobookwebapi1.azurewebsites.net/api/Picture/Preview/' + vuecomponent.EventPin + '/' + vuecomponent.EventPhotoIDs[e];\r\n\r\n                    await fetch(specificpictureurl, {\r\n                        credentials: 'include',\r\n                        mode: 'cors'\r\n                    })\r\n                        .then(function (response) {\r\n                            if (response.status == '200') {\r\n                                response.blob()\r\n                                    .then(image => {\r\n                                        vuecomponent.$set(vuecomponent.EventPhotos, e, URL.createObjectURL(image));\r\n\r\n                                    })\r\n                            }\r\n                            else {\r\n                                vuecomponent.$set(vuecomponent.EventPhotos, e, null);\r\n                            }\r\n\r\n                        })\r\n                }\r\n                },\r\n                logout: function () {\r\n                var url = 'https://photobookwebapi1.azurewebsites.net/api/Account/Logout';\r\n\r\n                var router = this.$router;\r\n                var cookie = this.$cookie;\r\n\r\n                fetch(url, {\r\n                    method: 'POST',\r\n                    credentials: 'include',\r\n                    headers: new Headers({\r\n                        'Content-Type': 'application/json', 'Accept': 'application/json'\r\n                    }),\r\n                    mode: 'cors'\r\n                }).then(function (response) {\r\n                    if (response.status == '200' || response.status == '204') {\r\n                        cookie.delete('LoggedInGuest')\r\n                        cookie.delete('currenteventpin')\r\n                        cookie.delete('currenteventname')\r\n                        cookie.delete('currentguest')\r\n                        router.push({ name: 'Home' })\r\n\r\n                    }\r\n                    else {\r\n                        alert(\"Failed to log out\")\r\n                    }\r\n                })\r\n            },\r\n            getEventInfo: function () {\r\n                var vuecomponent = this;\r\n\r\n                var url = 'https://photobookwebapi1.azurewebsites.net/api/Event/' + vuecomponent.EventPin;\r\n\r\n                fetch(url, {\r\n                    credentials: 'include',\r\n                    mode: 'cors'\r\n                })\r\n                    .then(function (response) {\r\n                        if (response.status == '200') {\r\n                            response.json()\r\n                                .then(data => ({ body: data }))\r\n                                .then(function (data) {\r\n                                    vuecomponent.EventName = data.body.name;\r\n                                    vuecomponent.EventDescription = data.body.description;\r\n                                    vuecomponent.EventLocation = data.body.location;\r\n                                    {\r\n                                        let DateObject = new Date(Date.parse(data.body.startDate));\r\n                                        let FullDateString = DateObject.toString();\r\n                                        var dateArray = FullDateString.split('');\r\n                                        dateArray.splice(FullDateString.indexOf('GMT') - 4);\r\n                                        var shorterDate = dateArray.join('');\r\n                                        vuecomponent.EventStarttime = shorterDate;\r\n                                    }\r\n                                    {\r\n                                        let DateObject = new Date(Date.parse(data.body.endDate));\r\n                                        let FullDateString = DateObject.toString();\r\n                                        var dateArray = FullDateString.split('');\r\n                                        dateArray.splice(FullDateString.indexOf('GMT') - 4);\r\n                                        var shorterDate = dateArray.join('');\r\n                                        vuecomponent.EventEndtime = shorterDate;\r\n                                    }\r\n                                      \r\n                                })\r\n\r\n                        }\r\n                    })\r\n\r\n\r\n            },\r\n        },\r\n        data() {\r\n            return {\r\n                zippedPhotos: null,\r\n                EventPhotoIDs: [/*...*/],\r\n                EventPhotos: [/*...*/],\r\n                UploadPhotos: [/*...*/],\r\n                EventPin: null,\r\n                EventHostName: this.$cookie.get('LoggedInHostName'),\r\n                HostEmail: this.$cookie.get('LoggedInEmail'),\r\n                thisEventName: null,\r\n                EventDescription: null,\r\n                EventLocation: null,\r\n                EventStarttime: null,\r\n                EventEndtime: null,\r\n                bar: null\r\n                \r\n            }\r\n        },\r\n        beforeMount() {\r\n            if (this.$cookie.get('LoggedInHost') != 'True') {\r\n                this.$router.push({ name: 'Home' })\r\n                return;\r\n            }\r\n\r\n            if (this.$cookie.get('currenteventname') == null) {\r\n                this.$cookie.set('currenteventname', this.$route.params.EventName)\r\n                this.$cookie.set('currenteventpin', this.$route.params.Pin)\r\n                \r\n            }\r\n            else if (this.$route.params.EventName != null && this.$cookie.get('currenteventname') != this.$route.params.EventName) {\r\n                this.$cookie.set('currenteventname', this.$route.params.EventName);\r\n                this.$cookie.set('currenteventpin', this.$route.params.Pin);\r\n            }\r\n\r\n            this.EventPin = this.$cookie.get('currenteventpin');\r\n            this.thisEventName = this.$cookie.get('currenteventname');\r\n\r\n            this.getEventPhotos();\r\n            this.getEventInfo();\r\n            \r\n        },     \r\n        mounted() {\r\n            var ProgressBar = require('progressbar.js')\r\n            this.bar = new ProgressBar.Circle(container, {\r\n                strokeWidth: 10,\r\n                easing: 'easeInOut',\r\n                duration: 500,\r\n                color: '#f4766f',\r\n                trailWidth: 0,\r\n                svgStyle: null\r\n            });\r\n\r\n            \r\n        },\r\n        \r\n        \r\n      \r\n    }\r\n\r\n\r\n\r\n</script>\r\n\r\n<style scoped>\r\n\r\n\r\n</style>"],"sourceRoot":"src/components"}]}